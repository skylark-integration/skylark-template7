/**
 * skylark-utils-templating - The skylark template engine library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){function r(t,e){if("."!==t[0])return t;var r=e.split("/"),n=t.split("/");r.pop();for(var i=0;i<n.length;i++)"."!=n[i]&&(".."==n[i]?r.pop():r.push(n[i]));return r.join("/")}var n=e.define,i=e.require,a="function"==typeof n&&n.amd,l=!a&&"undefined"!=typeof exports;if(!a&&!n){var o={};n=e.define=function(t,e,n){"function"==typeof n?(o[t]={factory:n,deps:e.map(function(e){return r(e,t)}),exports:null},i(t)):o[t]=n},i=e.require=function(t){if(!o.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var e=o[t];if(!e.exports){var r=[];e.deps.forEach(function(t){r.push(i(t))}),e.exports=e.factory.apply(window,r)}return e.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(t(n,i),!a){var s=i("skylark-langx/skylark");l?exports=s:e.skylarkjs=s}}(function(e,r){e("skylark-langx/skylark",[],function(){var t={};return t}),e("skylark-utils-templating/templating",["skylark-langx/skylark"],function(t){return t.templating={helpers:{}}}),e("skylark-langx/types",[],function(){function t(t){return t&&t.constructor===Array}function e(t){return!c(t)&&!o(t)&&"number"==typeof t.length&&!l(t)}function r(t){return"boolean"==typeof t}function n(t){return"undefined"!=typeof t}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function a(t){var e;for(e in t)if(null!==t[e])return!1;return!0}function l(t){return"function"==v(t)}function o(t){return t&&t instanceof Node}function s(t){return"number"==typeof t}function u(t){return"object"==v(t)}function f(t){return u(t)&&!p(t)&&Object.getPrototypeOf(t)==Object.prototype}function c(t){return"string"==typeof t}function p(t){return t&&t==t.window}function h(t){if(t){var e=location.protocol+"//"+location.hostname;return location.port&&(e+=":"+location.port),t.startsWith(e)}}var v=function(){var t={};return"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function(e){t["[object "+e+"]"]=e.toLowerCase()}),function(e){return null==e?String(e):t[toString.call(e)]||"object"}}();return{isArray:t,isArrayLike:e,isBoolean:r,isDefined:n,isDocument:i,isEmptyObject:a,isFunction:l,isHtmlNode:o,isNumber:s,isObject:u,isPlainObject:f,isString:c,isSameOrigin:h,isWindow:p,type:v}}),e("skylark-langx/objects",["./types"],function(t){function e(t,e){return function(r){var n=arguments.length;if(e&&(r=Object(r)),n<2||null==r)return r;for(var i=1;i<n;i++)for(var a=arguments[i],l=t(a),o=l.length,s=0;s<o;s++){var u=l[s];e&&void 0!==r[u]||(r[u]=a[u])}return r}}function r(t){if(!b(t))return[];var e=[];for(var r in t)e.push(r);return e}function n(t){if(b(t))return[];var e=[];for(var r in t)i(t,r)&&e.push(r);return e}function i(t,e){if(!j(e))return null!=t&&d.call(t,e);for(var r=e.length,n=0;n<r;n++){var i=e[n];if(null==t||!d.call(t,i))return!1;t=t[i]}return!!r}function a(t,e){return y(t,e)}function l(t,e){var r=r(e),n=r.length;if(null==t)return!n;for(var i=Object(t),a=0;a<n;a++){var l=r[a];if(e[l]!==i[l]||!(l in i))return!1}return!0}function o(t,e,r,n){for(var i in e)n&&void 0!==t[i]||(r&&(O(e[i])||j(e[i]))?(O(e[i])&&!O(t[i])&&(t[i]={}),j(e[i])&&!j(t[i])&&(t[i]=[]),o(t[i],e[i],r,n)):void 0!==e[i]&&(t[i]=e[i]));return t}function s(t){var e=m.call(arguments,0),r=e.shift(),n=!1;return k(e[e.length-1])&&(n=e.pop()),{target:r,sources:e,deep:n}}function u(){var t=s.apply(this,arguments);return t.sources.forEach(function(e){o(t.target,e,t.deep,!1)}),t.target}function f(t,e){if(j(t)){var r=t.indexOf(e);r!=-1&&t.splice(r,1)}else if(O(t))for(var n in t)if(t[n]==e){delete t[n];break}return this}function c(t,e,r){j(e)||(e=[e]);var n=e.length;if(!n)return x(r)?r.call(t):r;for(var i=0;i<n;i++){var a=null==t?void 0:t[e[i]];void 0===a&&(a=r,i=n),t=x(a)?a.call(t):a}return t}function p(){var t=s.apply(this,arguments);return t.sources.forEach(function(e){o(t.target,e,t.deep,!0)}),t.target}function h(t){for(var e=_.keys(t),r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t[e[i]];return n}function v(t,e){var r;if(void 0===t||null===t)r=t;else if(e&&t.clone)r=t.clone();else if(j(t)){r=[];for(var n=0;n<t.length;n++)r.push(v(t[n]))}else if(O(t)){r={};for(var i in t)r[i]=v(t[i])}else r=t;return r}var y,g,d=Object.prototype.hasOwnProperty,m=Array.prototype.slice,k=t.isBoolean,x=t.isFunction,b=t.isObject,O=t.isPlainObject,j=t.isArray,w="undefined"!=typeof Symbol?Symbol.prototype:null;return y=function(t,e,r,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&g(t,e,r,n)},g=function(t,e,r,n){var i=toString.call(t);if(i!==toString.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return w.valueOf.call(t)===w.valueOf.call(e)}var a="[object Array]"===i;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,o=e.constructor;if(l!==o&&!(x(l)&&l instanceof l&&x(o)&&o instanceof o)&&"constructor"in t&&"constructor"in e)return!1}r=r||[],n=n||[];for(var s=r.length;s--;)if(r[s]===t)return n[s]===e;if(r.push(t),n.push(e),a){if(s=t.length,s!==e.length)return!1;for(;s--;)if(!y(t[s],e[s],r,n))return!1}else{var u,f=Object.keys(t);if(s=f.length,Object.keys(e).length!==s)return!1;for(;s--;)if(u=f[s],void 0===e[u]||!y(t[u],e[u],r,n))return!1}return r.pop(),n.pop(),!0},{allKeys:r,clone:v,defaults:e(r,!0),has:i,isEqual:a,isMatch:l,keys:n,mixin:u,removeItem:f,result:c,safeMixin:p,values:h}}),e("skylark-langx/arrays",["./types"],function(t){function e(t){return s.call(t,function(t){return null!=t})}function r(t,e){var r,n,i,a,l;if(t)if(r=t.length,r===a){for(n in t)if(t.hasOwnProperty(n)&&(l=t[n],e.call(l,n,l)===!1))break}else for(i=0;i<r&&(l=t[i],e.call(l,i,l)!==!1);i++);return this}function n(t){if(u(t)){for(var e=[],r=0;r<t.length;r++){var n=t[r];if(u(n))for(var i=0;i<n.length;i++)e.push(n[i]);else e.push(n)}return e}return t}function i(t,e){if(!e)return-1;var r;if(e.indexOf)return e.indexOf(t);for(r=e.length;r--;)if(e[r]===t)return r;return-1}function a(t,e,r){return u(t)?(r||[]).concat(Array.prototype.slice.call(t,e||0)):[t]}function l(t,e){var r,i,a,l=[];if(u(t))for(i=0;i<t.length;i++)r=e.call(t[i],t[i],i),null!=r&&l.push(r);else for(a in t)r=e.call(t[a],t[a],a),null!=r&&l.push(r);return n(l)}function o(t){return s.call(t,function(e,r){return t.indexOf(e)==r})}var s=Array.prototype.filter,u=t.isArrayLike;return{compact:e,first:function(t,e){return e?t.slice(0,e):t[0]},each:r,flatten:n,inArray:i,makeArray:a,map:l,uniq:o}}),e("skylark-langx/klass",["./arrays","./objects","./types"],function(t,e,r){var n=t.uniq,i=e.has,a=e.mixin,l=r.isArray,o=r.isDefined,s=function(){function t(t,e,r){var n=t.prototype,i=t.superclass.prototype,a=r&&r.noOverrided;for(var l in e)if("constructor"!==l){var o=e[l];"function"==typeof e[l]?n[l]=o._constructor||a||"function"!=typeof i[l]?o:function(t,e,r){return function(){var t=this.overrided;this.overrided=r;var n=e.apply(this,arguments);return this.overrided=t,n}}(l,o,i[l]):"object"==typeof o&&null!==o&&o.get?Object.defineProperty(n,l,o):n[l]=o}return t}function e(t,e){var r=[];return e.forEach(function(t){if(i(t,"__mixins__"))throw new Error("nested mixins");for(var e=[];t;)e.unshift(t),t=t.superclass;r=r.concat(e)}),r=n(r),r=r.filter(function(e){for(var r=t;r;){if(e===r)return!1;if(i(r,"__mixins__"))for(var n=r.__mixins__,a=0;a<n.length;a++)if(n[a]===e)return!1;r=r.superclass}return!0}),r.length>0&&r}function r(t,e){for(var r=t,n=0;n<e.length;n++){var i=new Function;i.prototype=Object.create(r.prototype),i.__proto__=r,i.superclass=null,a(i.prototype,e[n].prototype),i.prototype.__mixin__=e[n],r=i}return r}return function s(n,i,a,u){l(i)&&(u=a,a=i,i=null),i=i||Object,o(a)&&!l(a)&&(u=a,a=!1);var f=i;a&&(a=e(f,a)),a&&(f=r(f,a));var c=n.constructor;c===Object&&(c=function(){if(this.init)return this.init.apply(this,arguments)});var p=n.klassName||"",h=new Function("return function "+p+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return h._constructor=c,h.prototype=Object.create(f.prototype),h.prototype.constructor=h,h.superclass=i,h.__proto__=f,a&&(h.__mixins__=a),h.partial||(h.partial=function(e,r){return t(this,e,r)}),h.inherit||(h.inherit=function(t,e,r){return s(t,this,e,r)}),h.partial(n,u),h}},u=s();return u}),e("skylark-langx/Evented",["./klass","./objects","./types"],function(t,e,r){var n=Array.prototype.slice,i=r.isDefined,a=r.isPlainObject,l=r.isFunction,o=r.isString,s=r.isEmptyObject,u=e.mixin,f=t({on:function(t,e,r,n,i,s){var u=this,f=this._hub||(this._hub={});return a(t)?(i=n,each(t,function(t,n){u.on(t,e,r,n,i,s)}),this):(o(e)||l(n)||(i=n,n=r,r=e,e=void 0),l(r)&&(i=n,n=r,r=null),o(t)&&(t=t.split(/\s/)),t.forEach(function(t){(f[t]||(f[t]=[])).push({fn:n,selector:e,data:r,ctx:i,one:s})}),this)},one:function(t,e,r,n,i){return this.on(t,e,r,n,i,1)},trigger:function(t){if(!this._hub)return this;var e=this;o(t)&&(t=new CustomEvent(t)),Object.defineProperty(t,"target",{value:this});var r=n.call(arguments,1);return r=i(r)?[t].concat(r):[t],[t.type||t.name,"all"].forEach(function(n){var i=e._hub[n];if(i){for(var a=i.length,l=!1,o=0;o<a;o++){var s=i[o];t.data?s.data&&(t.data=u({},s.data,t.data)):t.data=s.data||null,s.fn.apply(s.ctx,r),s.one&&(i[o]=null,l=!0)}l&&(e._hub[n]=compact(i))}}),this},listened:function(t){var e=(this._hub||(this._events={}))[t]||[];return e.length>0},listenTo:function(t,e,r,n){if(!t)return this;o(r)&&(r=this[r]),n?t.one(e,r,this):t.on(e,r,this);for(var i,a=this._listeningTo||(this._listeningTo=[]),l=0;l<a.length;l++)if(a[l].obj==t){i=a[l];break}i||a.push(i={obj:t,events:{}});var s=i.events,u=s[e]=s[e]||[];return u.indexOf(r)==-1&&u.push(r),this},listenToOnce:function(t,e,r){return this.listenTo(t,e,r,1)},off:function(t,e){var r=this._hub||(this._hub={});return o(t)&&(t=t.split(/\s/)),t.forEach(function(t){var n=r[t],i=[];if(n&&e)for(var a=0,l=n.length;a<l;a++)n[a].fn!==e&&n[a].fn._!==e&&i.push(n[a]);i.length?r[t]=i:delete r[t]}),this},unlistenTo:function(t,e,r){var n=this._listeningTo;if(!n)return this;for(var i=0;i<n.length;i++){var a=n[i];if(!t||t==a.obj){var l=a.events;for(var o in l)if(!e||e==o){for(var u=l[o],f=0;f<u.length;f++)r&&r!=u[i]||(a.obj.off(o,u[i],this),u[i]=null);u=l[o]=compact(u),s(u)&&(l[o]=null)}s(l)&&(n[i]=null)}}return n=this._listeningTo=compact(n),s(n)&&(this._listeningTo=null),this}});return f}),e("skylark-utils-templating/helpers/each",["skylark-langx/types","../templating"],function(t,e){return e.helpers.each=function(e,r){var n="",i=0;if(t.isFunction(e)&&(e=e.call(this)),t.isArray(e)){for(r.hash.reverse&&(e=e.reverse()),i=0;i<e.length;i++)e[i].templater=this.templater,n+=r.fn(e[i],{first:0===i,last:i===e.length-1,index:i});r.hash.reverse&&(e=e.reverse())}else for(var a in e)i++,e[a].templater=this.templater,n+=r.fn(e[a],{key:a});return i>0?n:r.inverse(this)}}),e("skylark-utils-templating/helpers/if",["skylark-langx/types","../templating"],function(t,e){return e.helpers["if"]=function(e,r){return t.isFunction(e)&&(e=e.call(this)),e?r.fn(this,r.data):r.inverse(this,r.data)}}),e("skylark-utils-templating/helpers/join",["skylark-langx/types","../templating"],function(t,e){return e.helpers.join=function(e,r){return t.isFunction(e)&&(e=e.call(this)),e.join(r.hash.delimiter)}}),e("skylark-utils-templating/helpers/js",["skylark-langx/types","../templating"],function(t,e){return e.helpers.js=function(t,e){var r;return r=t.indexOf("return")>=0?"(function(){"+t+"})":"(function(){return ("+t+")})",eval.call(this,r).call(this)}}),e("skylark-utils-templating/helpers/js_compare",["skylark-langx/types","../templating"],function(t,e){return e.helpers.js_compare=function(t,e){var r;r=t.indexOf("return")>=0?"(function(){"+t+"})":"(function(){return ("+t+")})";var n=eval.call(this,r).call(this);return n?e.fn(this,e.data):e.inverse(this,e.data)}}),e("skylark-utils-templating/helpers/partial",["skylark-langx/types","../templating"],function(t,e){return e.helpers.partial=function(t,e){const r=this,n=this.templater._partials[t];return!n||n&&!n.template?"":(n.compiled||(n.compiled=this.templater.compile(n.template)),Object.keys(e.hash).forEach(function(t){r[t]=e.hash[t]}),n.compiled(r,e.data,e.root))}}),e("skylark-utils-templating/helpers/unless",["skylark-langx/types","../templating"],function(t,e){return e.helpers.unless=function(e,r){return t.isFunction(e)&&(e=e.call(this)),e?r.inverse(this,r.data):r.fn(this,r.data)}}),e("skylark-utils-templating/helpers/with",["skylark-langx/types","../templating"],function(t,e){return e.helpers["with"]=function(e,r){return t.isFunction(e)&&(e=e.call(this)),r.fn(e)}}),e("skylark-utils-templating/Templater",["skylark-langx/types","skylark-langx/objects","skylark-langx/Evented","./templating","./helpers/each","./helpers/if","./helpers/join","./helpers/js","./helpers/js_compare","./helpers/partial","./helpers/unless","./helpers/with"],function(e,r,n,i,a,l,o,s,u,f,c,p){"use strict";function h(t){var e,r,n,i=t.replace(/[{}#}]/g,"").split(" "),a=[];for(r=0;r<i.length;r++){var l=i[r];if(0===r)a.push(l);else if(0===l.indexOf('"'))if(2===l.match(/"/g).length)a.push(l);else{for(e=0,n=r+1;n<i.length;n++)if(l+=" "+i[n],i[n].indexOf('"')>=0){e=n,a.push(l);break}e&&(r=e)}else if(l.indexOf("=")>0){var o=l.split("="),s=o[0],u=o[1];if(2!==u.match(/"/g).length){for(e=0,n=r+1;n<i.length;n++)if(u+=" "+i[n],i[n].indexOf('"')>=0){e=n;break}e&&(r=e)}var f=[s,u.replace(/"/g,"")];a.push(f)}else a.push(l)}return a}function v(t){var r,n,i=[];if(!t)return[];var a=t.split(/({{[^{^}]*}})/);for(r=0;r<a.length;r++){var l=a[r];if(""!==l)if(l.indexOf("{{")<0)i.push({type:"plain",content:l});else{if(l.indexOf("{/")>=0)continue;if(l.indexOf("{#")<0&&l.indexOf(" ")<0&&l.indexOf("else")<0){i.push({type:"variable",contextName:l.replace(/[{}]/g,"")});continue}var o=h(l),s=o[0],u=">"===s,f=[],c={};for(n=1;n<o.length;n++){var p=o[n];e.isArray(p)?c[p[0]]="false"!==p[1]&&p[1]:f.push(p)}if(l.indexOf("{#")>=0){var v,y="",g="",d=0,m=!1,k=!1,x=0;for(n=r+1;n<a.length;n++)if(a[n].indexOf("{{#")>=0&&x++,a[n].indexOf("{{/")>=0&&x--,a[n].indexOf("{{#"+s)>=0)y+=a[n],k&&(g+=a[n]),d++;else if(a[n].indexOf("{{/"+s)>=0){if(!(d>0)){v=n,m=!0;break}d--,y+=a[n],k&&(g+=a[n])}else a[n].indexOf("else")>=0&&0===x?k=!0:(k||(y+=a[n]),k&&(g+=a[n]));m&&(v&&(r=v),i.push({type:"helper",helperName:s,contextName:f,content:y,inverseContent:g,hash:c}))}else l.indexOf(" ")>0&&(u&&(s="partial",f[0]&&(0===f[0].indexOf("[")?f[0]=f[0].replace(/[[\]]/g,""):f[0]=f[0].replace(/"|'/g,""))),i.push({type:"helper",helperName:s,contextName:f,hash:c}))}}return i}var y=n.inherit({klassName:"Templater",init:function(t,e){this._options=t||{},this._helpers=r.mixin({each:a,"if":l,join:o,js:s,js_compare:u,partial:f,unless:c,"with":p},e),this._partials={},this._cache={}},compile:function(e){function r(t,e){return t.content?l(t.content,e):function(){return""}}function n(t,e){return t.inverseContent?l(t.inverseContent,e):function(){return""}}function i(t,e){var r,n,i=0;if(0===t.indexOf("../")){i=t.split("../").length-1;var a=e.split("_")[1]-i;e="ctx_"+(a>=1?a:1),n=t.split("../")[i].split(".")}else 0===t.indexOf("@global")?(e="$.Template7.global",n=t.split("@global.")[1].split(".")):0===t.indexOf("@root")?(e="ctx_1",n=t.split("@root.")[1].split(".")):n=t.split(".");r=e;for(var l=0;l<n.length;l++){var o=n[l];0===o.indexOf("@")?l>0?r+="[(data && data."+o.replace("@","")+")]":r="(data && data."+t.replace("@","")+")":isFinite(o)?r+="["+o+"]":0===o.indexOf("this")?r=o.replace("this",e):r+="."+o}return r}function a(t,e){for(var r=[],n=0;n<t.length;n++)0===t[n].indexOf('"')?r.push(t[n]):r.push(i(t[n],e));return r.join(", ")}function l(e,l){if(l=l||1,e=e||t.template,"string"!=typeof e)throw new Error("Template7: Template must be a string");var s=v(e);if(0===s.length)return function(){return""};var u="ctx_"+l,f="(function ("+u+", data) {\n";1===l&&(f+=u+".templater = this\n",f+="function isArray(arr){return Object.prototype.toString.apply(arr) === '[object Array]';}\n",f+="function isFunction(func){return (typeof func === 'function');}\n",f+='function c(val, ctx) {if (typeof val !== "undefined") {if (isFunction(val)) {return val.call(ctx);} else return val;} else return "";}\n'),f+="var r = '';\n";var c;for(c=0;c<s.length;c++){var p=s[c];if("plain"!==p.type){var h,y;if("variable"===p.type&&(h=i(p.contextName,u),f+="r += c("+h+", "+u+");"),"helper"===p.type)if(p.helperName in o._helpers)y=a(p.contextName,u),f+="r += "+u+".templater._helpers."+p.helperName+".call("+u+", "+(y&&y+", ")+"{hash:"+JSON.stringify(p.hash)+", data: data || {}, fn: "+r(p,l+1)+", inverse: "+n(p,l+1)+", root: ctx_1});";else{if(p.contextName.length>0)throw new Error('Missing helper: "'+p.helperName+'"');h=i(p.helperName,u),f+="if ("+h+") {",f+="if (isArray("+h+")) {",f+="r += "+u+".templater._helpers.each.call("+u+", "+h+", {hash:"+JSON.stringify(p.hash)+", data: data || {}, fn: "+r(p,l+1)+", inverse: "+n(p,l+1)+", root: ctx_1});",f+="}else {",f+="r += "+u+".templater._helpers.with.call("+u+", "+h+", {hash:"+JSON.stringify(p.hash)+", data: data || {}, fn: "+r(p,l+1)+", inverse: "+n(p,l+1)+", root: ctx_1});",f+="}}"}}else f+="r +='"+p.content.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/'/g,"\\'")+"';"}return f+="\nreturn r;})",eval.call(window,f)}var o=this,s=this._cache[e];if(!s){var u=l(e);s=this._cache[e]=function(){return u.apply(o,arguments)}}return s},render:function(t,e){var r=this.compile(t);return r(e)},registerHelper:function(t,e){this._helpers[t]=e},unregisterHelper:function(t){this._helpers[t]=void 0,delete this._helpers[t]},registerPartial:function(t,e){this._partials[t]={template:e}},unregisterPartial:function(t){this._partials[t]&&(this._partials[t]=void 0,delete this._partials[t])}}),g=y.defaultTemplater=new y;return["registerHelper","registerPartial","unregisterHelper","unregisterPartial","render","compile"].forEach(function(t){i[t]=function(){return y.prototype[t].apply(g,arguments)}}),i.Templater=y}),e("skylark-utils-templating/main",["./templating","./Templater"],function(t){return t}),e("skylark-utils-templating",["skylark-utils-templating/main"],function(t){return t})},this);
//# sourceMappingURL=sourcemaps/skylark-utils-templating-all.js.map
