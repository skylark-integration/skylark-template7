/**
 * skylark-template7 - A version of template7.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(n,e){var r=e.define,require=e.require,i="function"==typeof r&&r.amd,a=!i&&"undefined"!=typeof exports;if(!i&&!r){var s={};r=e.define=function(n,t,e){"function"==typeof e?(s[n]={factory:e,deps:t.map(function(t){return function(n,t){if("."!==n[0])return n;var e=t.split("/"),r=n.split("/");e.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?e.pop():e.push(r[i]));return e.join("/")}(t,n)}),resolved:!1,exports:null},require(n)):s[n]={factory:null,resolved:!0,exports:e}},require=e.require=function(n){if(!s.hasOwnProperty(n))throw new Error("Module "+n+" has not been defined");var module=s[n];if(!module.resolved){var t=[];module.deps.forEach(function(n){t.push(require(n))}),module.exports=module.factory.apply(e,t)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(n,require){n("skylark-langx-ns/_attach",[],function(){return function(n,t,e){"string"==typeof t&&(t=t.split("."));for(var r=t.length,i=n,a=0,s=t[a++];a<r;)i=i[s]=i[s]||{},s=t[a++];return i[s]=e}}),n("skylark-langx-ns/ns",["./_attach"],function(n){var t={attach:function(e,r){return n(t,e,r)}};return t}),n("skylark-langx-ns/main",["./ns"],function(n){return n}),n("skylark-langx-ns",["skylark-langx-ns/main"],function(n){return n}),n("skylark-langx/skylark",["skylark-langx-ns"],function(n){return n}),n("skylark-template7/templating",["skylark-langx/skylark"],function(n){return n.attach("intg.template7",{helpers:{}})}),n("skylark-langx-types/types",["skylark-langx-ns"],function(n){var t,e=Array.isArray,r={}.toString,i=(t={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(n){t["[object "+n+"]"]=n.toLowerCase()}),function(n){return null==n?String(n):t[r.call(n)]||"object"}),a=e||function(n){return object&&object.constructor===Array};function s(n){var t;for(t in n)if(null!==n[t])return!1;return!0}function l(n){return"function"==i(n)}function o(n){return n&&n.nodeType}function u(n){return"number"==typeof n}function c(n){var t=typeof n;return"function"===t||"object"===t&&!!n}function f(n){return"string"==typeof n}function p(n){return n&&n==n.window}return n.attach("langx.types",{isArray:a,isArrayLike:function(n){return!f(n)&&!o(n)&&"number"==typeof n.length&&!l(n)},isBoolean:function(n){return!0===n||!1===n||"[object Boolean]"===r.call(n)},isDefined:function(n){return void 0!==n},isDocument:function(n){return null!=n&&n.nodeType==n.DOCUMENT_NODE},isElement:function(n){return!(!n||1!==n.nodeType)},isEmpty:s,isEmptyObject:s,isFunction:l,isHtmlNode:o,isNaN:function(n){return isNaN(n)},isNull:function(n){return null===n},isNumber:u,isNumeric:u,isObject:c,isPlainObject:function(n){return c(n)&&!p(n)&&Object.getPrototypeOf(n)==Object.prototype},isString:f,isSameOrigin:function(n){if(n){var t=location.protocol+"//"+location.hostname;return location.port&&(t+=":"+location.port),n.startsWith(t)}},isSymbol:function(n){return"symbol"==typeof n||isObjectLike(n)&&objectToString.call(n)==symbolTag},isUndefined:function(n){return void 0===n},isWindow:p,type:i})}),n("skylark-langx-types/main",["./types"],function(n){return n}),n("skylark-langx-types",["skylark-langx-types/main"],function(n){return n}),n("skylark-langx/types",["skylark-langx-types"],function(n){return n}),n("skylark-langx-numbers/numbers",["skylark-langx-ns","skylark-langx-types"],function(n,t){var e=t.isObject,r=t.isSymbol,i=1/0,a=1.7976931348623157e308,s=NaN,l=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;function p(n){if(!n)return 0===n?n:0;if((n=h(n))===i||n===-i){var t=n<0?-1:1;return t*a}return n==n?n:0}function h(n){if("number"==typeof n)return n;if(r(n))return s;if(e(n)){var t="function"==typeof n.valueOf?n.valueOf():n;n=e(t)?t+"":t}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(l,"");var i=u.test(n);return i||c.test(n)?f(n.slice(2),i?2:8):o.test(n)?s:+n}return n.attach("langx.numbers",{toFinite:p,toNumber:h,toInteger:function(n){var t=p(n),e=t%1;return t==t?e?t-e:t:0}})}),n("skylark-langx-numbers/main",["./numbers"],function(n){return n}),n("skylark-langx-numbers",["skylark-langx-numbers/main"],function(n){return n}),n("skylark-langx-objects/objects",["skylark-langx-ns/ns","skylark-langx-ns/_attach","skylark-langx-types","skylark-langx-numbers"],function(n,t,e,r){var i,a,s=Object.prototype.hasOwnProperty,l=Array.prototype.slice,o=e.isBoolean,u=e.isFunction,c=e.isObject,f=e.isPlainObject,p=e.isArray,h=e.isArrayLike,y=e.isString,g=r.toInteger;var v,k,m="undefined"!=typeof Symbol?Symbol.prototype:null;function d(n){if(!c(n))return[];var t=[];for(var e in n)t.push(e);return t}function x(n,t){if(!p(t))return null!=n&&s.call(n,t);for(var e=t.length,r=0;r<e;r++){var i=t[r];if(null==n||!s.call(n,i))return!1;n=n[i]}return!!e}function b(n,t,e,r){for(var i in t)r&&void 0!==n[i]||(e&&f(t[i])?(f(n[i])||(n[i]={}),b(n[i],t[i],e,r)):void 0!==t[i]&&(n[i]=t[i]));return n}function _(n){var t=l.call(arguments,0),e=t.shift(),r=!1;return o(t[t.length-1])&&(r=t.pop()),{target:e,sources:t,deep:r}}function j(){var n=_.apply(this,arguments);return n.sources.forEach(function(t){b(n.target,t,n.deep,!1)}),n.target}function O(n){for(var t=d(n),e=t.length,r=Array(e),i=0;i<e;i++)r[i]=n[t[i]];return r}return i=function(n,t,e,r){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return!1;if(n!=n)return t!=t;var i=typeof n;return("function"===i||"object"===i||"object"==typeof t)&&a(n,t,e,r)},a=function(n,t,e,r){var a=toString.call(n);if(a!==toString.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!=+n?+t!=+t:0==+n?1/+n==1/t:+n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object Symbol]":return m.valueOf.call(n)===m.valueOf.call(t)}var s="[object Array]"===a;if(!s){if("object"!=typeof n||"object"!=typeof t)return!1;var l=n.constructor,o=t.constructor;if(l!==o&&!(u(l)&&l instanceof l&&u(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1}e=e||[],r=r||[];for(var c=e.length;c--;)if(e[c]===n)return r[c]===t;if(e.push(n),r.push(t),s){if((c=n.length)!==t.length)return!1;for(;c--;)if(!i(n[c],t[c],e,r))return!1}else{var f,p=Object.keys(n);if(c=p.length,Object.keys(t).length!==c)return!1;for(;c--;)if(f=p[c],void 0===t[f]||!i(n[f],t[f],e,r))return!1}return e.pop(),r.pop(),!0},n.attach("langx.objects",{allKeys:d,attach:t,clone:function n(t,e){var r;if(void 0===t||null===t)r=t;else if(e&&t.clone)r=t.clone();else if(p(t)){r=[];for(var i=0;i<t.length;i++)r.push(n(t[i]))}else if(f(t))for(var a in r={},t)r[a]=n(t[a]);else r=t;return r},defaults:(v=d,k=!0,function(n){var t=arguments.length;if(k&&(n=Object(n)),t<2||null==n)return n;for(var e=1;e<t;e++)for(var r=arguments[e],i=v(r),a=i.length,s=0;s<a;s++){var l=i[s];k&&void 0!==n[l]||(n[l]=r[l])}return n}),each:function(n,t,e){var r,i,a,s;if(n)if(void 0===(r=n.length)){for(i in n)if(n.hasOwnProperty(i)&&(s=n[i],!1===(e?t.call(s,s,i):t.call(s,i,s))))break}else for(a=0;a<r&&(s=n[a],!1!==(e?t.call(s,s,a):t.call(s,a,s)));a++);return this},extend:function(n){var t,e=l.call(arguments,1);"boolean"==typeof n&&(t=n,n=e.shift());0==e.length&&(e=[n],n=this);return e.forEach(function(e){j(n,e,t)}),n},has:x,isEqual:function(n,t){return i(n,t)},includes:function(n,t,e,r){n=h(n)?n:O(n),e=e&&!r?g(e):0;var i=n.length;e<0&&(e=nativeMax(i+e,0));return y(n)?e<=i&&n.indexOf(t,e)>-1:!!i&&baseIndexOf(n,t,e)>-1},isMatch:function(n,t){var e=e(t),r=e.length;if(null==n)return!r;for(var i=Object(n),a=0;a<r;a++){var s=e[a];if(t[s]!==i[s]||!(s in i))return!1}return!0},keys:function(n){if(c(n))return[];var t=[];for(var e in n)x(n,e)&&t.push(e);return t},mixin:j,omit:function(n,t,e){if(!n)return null;for(var r=j({},n),i=1;i<arguments.length;i++){var a=arguments[i];a in n&&delete r[a]}return r},pick:function(n,t,e){if(!n)return null;for(var r={},i=1;i<arguments.length;i++){var a=arguments[i];a in n&&(r[a]=n[a])}return r},removeItem:function(n,t){if(p(n)){var e=n.indexOf(t);-1!=e&&n.splice(e,1)}else if(f(n))for(var r in n)if(n[r]==t){delete n[r];break}return this},result:function(n,t,e){p(t)||(t=t.split("."));var r=t.length;if(!r)return u(e)?e.call(n):e;for(var i=0;i<r;i++){var a=null==n?void 0:n[t[i]];void 0===a&&(a=e,i=r),n=u(a)?a.call(n):a}return n},safeMixin:function(){var n=_.apply(this,arguments);return n.sources.forEach(function(t){b(n.target,t,n.deep,!0)}),n.target},values:O})}),n("skylark-langx-objects/main",["./objects"],function(n){return n}),n("skylark-langx-objects",["skylark-langx-objects/main"],function(n){return n}),n("skylark-langx/objects",["skylark-langx-objects"],function(n){return n}),n("skylark-langx-arrays/arrays",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(n,t,e){var r=Array.prototype.filter,i=Array.prototype.find,a=t.isArrayLike;function s(n,t,e,r){for(var i=n.length,a=e+(r?1:-1);r?a--:++a<i;)if(t(n[a],a,n))return a;return-1}function l(n){return n!=n}function o(n){if(a(n)){for(var t=[],e=0;e<n.length;e++){var r=n[e];if(a(r))for(var i=0;i<r.length;i++)t.push(r[i]);else t.push(r)}return t}return n}return n.attach("langx.arrays",{baseFindIndex:s,baseIndexOf:function(n,t,e){if(t!=t)return s(n,l,e);var r=e-1,i=n.length;for(;++r<i;)if(n[r]===t)return r;return-1},compact:function(n){return r.call(n,function(n){return null!=n})},first:function(n,t){return t?n.slice(0,t):n[0]},filter:function(n,t){return r.call(n,t)},find:function(n,t){return i.call(n,t)},flatten:o,grep:function(n,t){var r=[];return e.each(n,function(n,e){t(e,n)&&r.push(e)}),r},inArray:function(n,t){if(!t)return-1;var e;if(t.indexOf)return t.indexOf(n);e=t.length;for(;e--;)if(t[e]===n)return e;return-1},makeArray:function(n,t,e){if(a(n))return(e||[]).concat(Array.prototype.slice.call(n,t||0));return[n]},merge:function(n,t){var e=t.length,r=n.length,i=0;if("number"==typeof e)for(;i<e;i++)n[r++]=t[i];else for(;void 0!==t[i];)n[r++]=t[i++];return n.length=r,n},forEach:function(n,t){if(n.forEach)return n.forEach(t);for(var e=0;e<n.length;e++)t(n[e],e)},map:function(n,t){var e,r,i,s=[];if(a(n))for(r=0;r<n.length;r++)null!=(e=t.call(n[r],n[r],r))&&s.push(e);else for(i in n)null!=(e=t.call(n[i],n[i],i))&&s.push(e);return o(s)},reduce:function(n,t,e){return Array.prototype.reduce.call(n,t,e)},uniq:function(n){return r.call(n,function(t,e){return n.indexOf(t)==e})}})}),n("skylark-langx-arrays/main",["./arrays"],function(n){return n}),n("skylark-langx-arrays",["skylark-langx-arrays/main"],function(n){return n}),n("skylark-langx-klass/klass",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays"],function(n,t,e,r){var i=r.uniq,a=e.has,s=e.mixin,l=t.isArray,o=t.isDefined;var u=function(){function n(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function e(r,u,c,f){l(u)&&(f=c,c=u,u=null),u=u||Object,o(c)&&!l(c)&&(f=c,c=!1);var p=u;c&&(c=function(n,t){var e=[];return t.forEach(function(n){if(a(n,"__mixins__"))throw new Error("nested mixins");for(var t=[];n;)t.unshift(n),n=n.superclass;e=e.concat(t)}),(e=(e=i(e)).filter(function(t){for(var e=n;e;){if(t===e)return!1;if(a(e,"__mixins__"))for(var r=e.__mixins__,i=0;i<r.length;i++)if(r[i]===t)return!1;e=e.superclass}return!0})).length>0&&e}(p,c)),c&&(p=function(n,t){for(var e=n,r=0;r<t.length;r++){var i=new Function;i.prototype=Object.create(e.prototype),i.__proto__=e,i.superclass=null,s(i.prototype,t[r].prototype),i.prototype.__mixin__=t[r],e=i}return e}(p,c));var h=r.klassName||"",y=new Function("return function "+h+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return y.prototype=Object.create(p.prototype),y.prototype.constructor=y,y.superclass=u,y.__proto__=p,y._constructor||(y._constructor=n),c&&(y.__mixins__=c),y.partial||(y.partial=function(n,e){return function(n,e,r){var i=n.prototype,a=n.superclass.prototype,s=r&&r.noOverrided;r&&r.overrides;for(var l in e)if("constructor"!==l){var o=e[l];"function"==typeof e[l]?i[l]=o._constructor||s||"function"!=typeof a[l]?o:function(n,t,e){return function(){var n=this.overrided;this.overrided=e;var r=t.apply(this,arguments);return this.overrided=n,r}}(0,o,a[l]):t.isPlainObject(o)&&null!==o&&o.get?Object.defineProperty(i,l,o):i[l]=o}return n}(this,n,e)}),y.inherit||(y.inherit=function(n,t,r){return e(n,this,t,r)}),y.partial(r,f),y}}();return n.attach("langx.klass",u)}),n("skylark-langx-klass/main",["./klass"],function(n){return n}),n("skylark-langx-klass",["skylark-langx-klass/main"],function(n){return n}),n("skylark-langx-events/events",["skylark-langx-ns"],function(n){return n.attach("langx.events",{})}),n("skylark-langx-funcs/funcs",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(n,t,e){var r=e.mixin,i=Array.prototype.slice,a=t.isFunction,s=t.isString;function l(n,t){var e=2 in arguments&&i.call(arguments,2);if(a(n)){return function(){return n.apply(t,e?e.concat(i.call(arguments)):arguments)}}if(s(t))return e?(e.unshift(n[t],n),l.apply(null,e)):l(n[t],n);throw new TypeError("expected function")}var o=function(){function n(){}return function(t,e){n.prototype=t;var i=new n;return n.prototype=null,e&&r(i,e),i}}(),u={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},c=/(.)^/,f={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},p=/\\|'|\r|\n|\t|\u2028|\u2029/g;return n.attach("langx.funcs",{bind:l,debounce:function(n,t){var e;return function(){var r=this,i=arguments;e&&clearTimeout(e),e=setTimeout(function(){e=null,n.apply(r,i)},t)}},delegate:o,defer:function(n){requestAnimationFrame?requestAnimationFrame(n):setTimeoutout(n);return this},negate:function(n){if("function"!=typeof n)throw new TypeError("Expected a function");return function(...t){return!n.apply(this,t)}},noop:function(){},proxy:l,returnTrue:function(){return!0},returnFalse:function(){return!1},templateSettings:u,template:function(n,t,r){var i;r=e.defaults({},r,u);var a=RegExp([(r.escape||c).source,(r.interpolate||c).source,(r.evaluate||c).source].join("|")+"|$","g"),s=0,o="__p+='";n.replace(a,function(t,e,r,i,a){return o+=n.slice(s,a).replace(p,function(n){return"\\"+f[n]}),e&&(o+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=a+t.length,t}),o+="';\n",r.variable||(o="with(obj||{}){\n"+o+"}\n");o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(r.variable||"obj","_",o)}catch(n){throw n.source=o,n}if(t)return i(t,this);var h=l(function(n){return i.call(this,n,this)},this),y=r.variable||"obj";return h.source="function("+y+"){\n"+o+"}",h}})}),n("skylark-langx-funcs/main",["./funcs"],function(n){return n}),n("skylark-langx-funcs",["skylark-langx-funcs/main"],function(n){return n}),n("skylark-langx-hoster/hoster",["skylark-langx-ns"],function(n){var t={isBrowser:!0,isNode:null,global:this,browser:null,node:null};"object"==typeof process&&process.versions&&process.versions.node&&process.versions.v8&&(t.isNode=!0,t.isBrowser=!1),t.global=function(){return"undefined"!=typeof global&&"function"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}();var e=null;if(Object.defineProperty(t,"document",function(){if(!e){var n="undefined"==typeof window?require("html-element"):window;e=n.document}return e}),void 0===t.global.CustomEvent&&(t.global.CustomEvent=function(n,t){this.type=n,this.props=t}),Object.defineProperty(t,"document",function(){if(!e){var n="undefined"==typeof window?require("html-element"):window;e=n.document}return e}),t.isBrowser){var r=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}}(navigator.userAgent),i=t.browser={};r.browser&&(i[r.browser]=!0,i.version=r.version),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0)}return n.attach("langx.hoster",t)}),n("skylark-langx-hoster/main",["./hoster"],function(n){return n}),n("skylark-langx-hoster",["skylark-langx-hoster/main"],function(n){return n}),n("skylark-langx-events/Event",["skylark-langx-objects","skylark-langx-funcs","skylark-langx-klass","skylark-langx-hoster"],function(n,t,e){var r={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function i(e,i){return!i&&e.isDefaultPrevented||(i||(i=e),n.each(r,function(n,r){var a=i[n];e[n]=function(){return this[r]=t.returnTrue,a&&a.apply(i,arguments)},e[r]=t.returnFalse})),e}class a extends CustomEvent{constructor(t,e){super(t,e),n.safeMixin(this,e),i(this)}}return a.compatible=i,a}),n("skylark-langx-events/Listener",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event"],function(n,t,e,r,i,a){Array.prototype.slice;var s=e.compact,l=(n.isDefined,n.isPlainObject,n.isFunction,n.isBoolean),o=n.isString,u=n.isEmptyObject,c=(t.mixin,t.safeMixin,r({listenTo:function(t,e,r,i){if(!t)return this;if(l(r)&&(i=r,r=null),n.isPlainObject(e)){var a=e;for(var s in a)this.listenTo(t,s,a[s],i);return this}r||(r="handleEvent"),o(r)&&(r=this[r]),i?t.one(e,r,this):t.on(e,r,this);for(var u,c=this._listeningTo||(this._listeningTo=[]),f=0;f<c.length;f++)if(c[f].obj==t){u=c[f];break}u||c.push(u={obj:t,events:{}});var p=u.events,h=p[e]=p[e]||[];return-1==h.indexOf(r)&&h.push(r),this},listenToOnce:function(n,t,e){return this.listenTo(n,t,e,1)},unlistenTo:function(n,t,e){var r=this._listeningTo;if(!r)return this;o(e)&&(e=this[e]);for(var i=0;i<r.length;i++){var a=r[i];if(!n||n==a.obj){var l=a.events;for(var c in l)if(!t||t==c){for(var f=l[c],p=0;p<f.length;p++)e&&e!=f[i]||(a.obj.off(c,f[i],this),f[i]=null);f=l[c]=s(f),u(f)&&(l[c]=null)}u(l)&&(r[i]=null)}}return r=this._listeningTo=s(r),u(r)&&(this._listeningTo=null),this}}));return i.Listener=c}),n("skylark-langx-events/Emitter",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event","./Listener"],function(n,t,e,r,i,a,s){var l=Array.prototype.slice,o=e.compact,u=n.isDefined,c=n.isPlainObject,f=n.isFunction,p=n.isString,h=(n.isEmptyObject,t.mixin);t.safeMixin;function y(n){var t=(""+n).split(".");return{name:t[0],ns:t.slice(1).join(" ")}}var g=s.inherit({on:function(n,t,e,r,i,a){var s=this,l=this._hub||(this._hub={});if(c(n))return i=r,each(n,function(n,r){s.on(n,t,e,r,i,a)}),this;if(p(t)||f(r)||(i=r,r=e,e=t,t=void 0),f(e)&&(i=r,r=e,e=null),!r)throw new Error("No callback function");if(!f(r))throw new Error("The callback  is not afunction");return p(n)&&(n=n.split(/\s/)),n.forEach(function(n){var s=y(n),o=s.name,u=s.ns;(l[o]||(l[o]=[])).push({fn:r,selector:t,data:e,ctx:i,ns:u,one:a})}),this},one:function(n,t,e,r,i){return this.on(n,t,e,r,i,1)},emit:function(n){if(!this._hub)return this;var t=this;p(n)&&(n=new a(n)),Object.defineProperty(n,"target",{value:this});var e=l.call(arguments,1);return e=u(e)?[n].concat(e):[n],[n.type||n.name,"all"].forEach(function(r){var i=y(r),a=i.name,s=i.ns,l=t._hub[a];if(l){for(var u=l.length,c=!1,f=0;f<u;f++){if(n.isImmediatePropagationStopped&&n.isImmediatePropagationStopped())return this;var p=l[f];(!s||p.ns&&p.ns.startsWith(s))&&(n.data?p.data&&(n.data=h({},p.data,n.data)):n.data=p.data||null,p.fn.apply(p.ctx,e),p.one&&(l[f]=null,c=!0))}c&&(t._hub[r]=o(l))}}),this},listened:function(n){var t=(this._hub||(this._events={}))[n]||[];return t.length>0},off:function(n,t){var e=this._hub||(this._hub={});return p(n)&&(n=n.split(/\s/)),n.forEach(function(n){var r=y(n),i=r.name,a=r.ns,s=e[i];if(s){var l=[];if(t||a)for(var o=0,u=s.length;o<u;o++)t&&s[o].fn!==t&&s[o].fn._!==t?l.push(s[o]):!a||s[o].ns&&0==s[o].ns.indexOf(a)||l.push(s[o]);l.length?e[i]=l:delete e[i]}}),this},trigger:function(){return this.emit.apply(this,arguments)}});return i.Emitter=g}),n("skylark-langx/Emitter",["skylark-langx-events/Emitter"],function(n){return n}),n("skylark-langx/Evented",["./Emitter"],function(n){return n}),n("skylark-template7/helpers/each",["skylark-langx/types","../templating"],function(n,t){return t.helpers.each=function(t,e){var r="",i=0;if(n.isFunction(t)&&(t=t.call(this)),n.isArray(t)){for(e.hash.reverse&&(t=t.reverse()),i=0;i<t.length;i++)t[i].templater=this.templater,r+=e.fn(t[i],{first:0===i,last:i===t.length-1,index:i});e.hash.reverse&&(t=t.reverse())}else for(var a in t)i++,t[a].templater=this.templater,r+=e.fn(t[a],{key:a});return i>0?r:e.inverse(this)}}),n("skylark-template7/helpers/if",["skylark-langx/types","../templating"],function(n,t){return t.helpers.if=function(t,e){return n.isFunction(t)&&(t=t.call(this)),t?e.fn(this,e.data):e.inverse(this,e.data)}}),n("skylark-template7/helpers/join",["skylark-langx/types","../templating"],function(n,t){return t.helpers.join=function(t,e){return n.isFunction(t)&&(t=t.call(this)),t.join(e.hash.delimiter)}}),n("skylark-template7/helpers/js",["skylark-langx/types","../templating"],function(n,t){return t.helpers.js=function(n,t){var e;return e=n.indexOf("return")>=0?"(function(){"+n+"})":"(function(){return ("+n+")})",eval.call(this,e).call(this)}}),n("skylark-template7/helpers/js_compare",["skylark-langx/types","../templating"],function(n,t){return t.helpers.js_compare=function(n,t){var e;e=n.indexOf("return")>=0?"(function(){"+n+"})":"(function(){return ("+n+")})";var r=eval.call(this,e).call(this);return r?t.fn(this,t.data):t.inverse(this,t.data)}}),n("skylark-template7/helpers/partial",["skylark-langx/types","../templating"],function(n,t){return t.helpers.partial=function(n,t){const e=this,r=this.templater._partials[n];return!r||r&&!r.template?"":(r.compiled||(r.compiled=this.templater.compile(r.template)),Object.keys(t.hash).forEach(function(n){e[n]=t.hash[n]}),r.compiled(e,t.data,t.root))}}),n("skylark-template7/helpers/unless",["skylark-langx/types","../templating"],function(n,t){return t.helpers.unless=function(t,e){return n.isFunction(t)&&(t=t.call(this)),t?e.inverse(this,e.data):e.fn(this,e.data)}}),n("skylark-template7/helpers/with",["skylark-langx/types","../templating"],function(n,t){return t.helpers.with=function(t,e){return n.isFunction(t)&&(t=t.call(this)),e.fn(t)}}),n("skylark-template7/Templater",["skylark-langx/types","skylark-langx/objects","skylark-langx/Evented","./templating","./helpers/each","./helpers/if","./helpers/join","./helpers/js","./helpers/js_compare","./helpers/partial","./helpers/unless","./helpers/with"],function(n,e,r,i,a,s,l,o,u,c,f,p){"use strict";function h(n){var t,e,r,i=n.replace(/[{}#}]/g,"").split(" "),a=[];for(e=0;e<i.length;e++){var s=i[e];if(0===e)a.push(s);else if(0===s.indexOf('"'))if(2===s.match(/"/g).length)a.push(s);else{for(t=0,r=e+1;r<i.length;r++)if(s+=" "+i[r],i[r].indexOf('"')>=0){t=r,a.push(s);break}t&&(e=t)}else if(s.indexOf("=")>0){var l=s.split("="),o=l[0],u=l[1];if(2!==u.match(/"/g).length){for(t=0,r=e+1;r<i.length;r++)if(u+=" "+i[r],i[r].indexOf('"')>=0){t=r;break}t&&(e=t)}var c=[o,u.replace(/"/g,"")];a.push(c)}else a.push(s)}return a}var y=r.inherit({klassName:"Templater",init:function(n,t){this._options=n||{},this._helpers=e.mixin({each:a,if:s,join:l,js:o,js_compare:u,partial:c,unless:f,with:p},t),this._partials={},this._cache={}},compile:function(e){var r=this;function i(n,t){return n.content?o(n.content,t):function(){return""}}function a(n,t){return n.inverseContent?o(n.inverseContent,t):function(){return""}}function s(n,t){var e,r,i=0;if(0===n.indexOf("../")){i=n.split("../").length-1;var a=t.split("_")[1]-i;t="ctx_"+(a>=1?a:1),r=n.split("../")[i].split(".")}else 0===n.indexOf("@global")?(t="$.Template7.global",r=n.split("@global.")[1].split(".")):0===n.indexOf("@root")?(t="ctx_1",r=n.split("@root.")[1].split(".")):r=n.split(".");e=t;for(var s=0;s<r.length;s++){var l=r[s];0===l.indexOf("@")?s>0?e+="[(data && data."+l.replace("@","")+")]":e="(data && data."+n.replace("@","")+")":isFinite(l)?e+="["+l+"]":0===l.indexOf("this")?e=l.replace("this",t):e+="."+l}return e}function l(n,t){for(var e=[],r=0;r<n.length;r++)0===n[r].indexOf('"')?e.push(n[r]):e.push(s(n[r],t));return e.join(", ")}function o(e,o){if(o=o||1,"string"!=typeof(e=e||t.template))throw new Error("Template7: Template must be a string");var u=function(t){var e,r,i=[];if(!t)return[];var a=t.split(/({{[^{^}]*}})/);for(e=0;e<a.length;e++){var s=a[e];if(""!==s)if(s.indexOf("{{")<0)i.push({type:"plain",content:s});else{if(s.indexOf("{/")>=0)continue;if(s.indexOf("{#")<0&&s.indexOf(" ")<0&&s.indexOf("else")<0){i.push({type:"variable",contextName:s.replace(/[{}]/g,"")});continue}var l=h(s),o=l[0],u=">"===o,c=[],f={};for(r=1;r<l.length;r++){var p=l[r];n.isArray(p)?f[p[0]]="false"!==p[1]&&p[1]:c.push(p)}if(s.indexOf("{#")>=0){var y,g="",v="",k=0,m=!1,d=!1,x=0;for(r=e+1;r<a.length;r++)if(a[r].indexOf("{{#")>=0&&x++,a[r].indexOf("{{/")>=0&&x--,a[r].indexOf("{{#"+o)>=0)g+=a[r],d&&(v+=a[r]),k++;else if(a[r].indexOf("{{/"+o)>=0){if(!(k>0)){y=r,m=!0;break}k--,g+=a[r],d&&(v+=a[r])}else a[r].indexOf("else")>=0&&0===x?d=!0:(d||(g+=a[r]),d&&(v+=a[r]));m&&(y&&(e=y),i.push({type:"helper",helperName:o,contextName:c,content:g,inverseContent:v,hash:f}))}else s.indexOf(" ")>0&&(u&&(o="partial",c[0]&&(0===c[0].indexOf("[")?c[0]=c[0].replace(/[[\]]/g,""):c[0]=c[0].replace(/"|'/g,""))),i.push({type:"helper",helperName:o,contextName:c,hash:f}))}}return i}(e);if(0===u.length)return function(){return""};var c,f="ctx_"+o,p="(function ("+f+", data) {\n";for(1===o&&(p+=f+".templater = this\n",p+="function isArray(arr){return Object.prototype.toString.apply(arr) === '[object Array]';}\n",p+="function isFunction(func){return (typeof func === 'function');}\n",p+='function c(val, ctx) {if (typeof val !== "undefined") {if (isFunction(val)) {return val.call(ctx);} else return val;} else return "";}\n'),p+="var r = '';\n",c=0;c<u.length;c++){var y,g,v=u[c];if("plain"!==v.type){if("variable"===v.type&&(y=s(v.contextName,f),p+="r += c("+y+", "+f+");"),"helper"===v.type)if(v.helperName in r._helpers)g=l(v.contextName,f),p+="r += "+f+".templater._helpers."+v.helperName+".call("+f+", "+(g&&g+", ")+"{hash:"+JSON.stringify(v.hash)+", data: data || {}, fn: "+i(v,o+1)+", inverse: "+a(v,o+1)+", root: ctx_1});";else{if(v.contextName.length>0)throw new Error('Missing helper: "'+v.helperName+'"');y=s(v.helperName,f),p+="if ("+y+") {",p+="if (isArray("+y+")) {",p+="r += "+f+".templater._helpers.each.call("+f+", "+y+", {hash:"+JSON.stringify(v.hash)+", data: data || {}, fn: "+i(v,o+1)+", inverse: "+a(v,o+1)+", root: ctx_1});",p+="}else {",p+="r += "+f+".templater._helpers.with.call("+f+", "+y+", {hash:"+JSON.stringify(v.hash)+", data: data || {}, fn: "+i(v,o+1)+", inverse: "+a(v,o+1)+", root: ctx_1});",p+="}}"}}else p+="r +='"+v.content.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/'/g,"\\'")+"';"}return p+="\nreturn r;})",eval.call(window,p)}var u=this._cache[e];if(!u){var c=o(e);u=this._cache[e]=function(){return c.apply(r,arguments)}}return u},render:function(n,t){var e=this.compile(n);return e(t)},registerHelper:function(n,t){this._helpers[n]=t},unregisterHelper:function(n){this._helpers[n]=void 0,delete this._helpers[n]},registerPartial:function(n,t){this._partials[n]={template:t}},unregisterPartial:function(n){this._partials[n]&&(this._partials[n]=void 0,delete this._partials[n])}}),g=y.defaultTemplater=new y;return["registerHelper","registerPartial","unregisterHelper","unregisterPartial","render","compile"].forEach(function(n){i[n]=function(){return y.prototype[n].apply(g,arguments)}}),i.Templater=y}),n("skylark-template7/main",["./templating","./Templater"],function(n){return n}),n("skylark-template7",["skylark-template7/main"],function(n){return n})}(r,require),!i){var l=require("skylark-langx-ns");a?module.exports=l:e.skylarkjs=l}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-template7-all.js.map
